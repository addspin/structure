{%extends "base.html"%}
{%block data%}
{{side_pos}}
{%endblock%}

{%block data_form%}

<div id="search" class="search">
    <form id="search_form" class="" >
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Управление:</span>
            <input class="form-control" list="datalistOptions" id="management" name="management" placeholder="Название управления или другой корневой структурной единицы" >
            <datalist id="datalistOptions" >
                {% for value in extract_management_data %}
                <option value="{{value.management_name}}">
                {% endfor %}
            </datalist>
                
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Отдел:</span>
            <input class="form-control" list="datalistOptions1" id="department" name="department" placeholder="Название отдела" >
            <datalist id="datalistOptions1">
                {% for value in extract_department_data %}
                <option value="{{value.department_name}}">
                {% endfor %}
            </datalist>
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Должность:</span>
            <input class="form-control" list="datalistOptions2" id="job" name="job" placeholder="Название должности" >
            <datalist id="datalistOptions2">
                {% for value in extract_job_data %}
                <option value="{{value.job_name}}">
                {% endfor %}
            </datalist>
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Пользователь:</span>
            <input class="form-control" list="datalistOptions/" id="user" name="user" placeholder="Ф.И.О" >
            <datalist id="datalistOptions/">
                {% for value in extract_user_name_data %}
                <option value="{{value.user_name}}">
                {% endfor %}
            </datalist>
        </div>
    </form>
    <div class="button_line">
        <div class="" >
            <input hx-trigger="click" hx-post="/data" hx-target="#main" hx-include="#search_form" class="btn btn-warning" type="submit" value="Добавить">
        </div>
        <div class="" >
            <input hx-trigger="click" hx-post="/remove_data" hx-target="#main" hx-include="#search_form" class="btn btn-danger" type="submit" value="Удалить">
        </div>
    </div>
    <div class="message_data">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
            {% if category == 'management-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'department-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'job-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'user-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'management-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'department-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'job-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'user-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% endif %}
        {% endfor %}
    {% endwith %}
    </div>
</div>



<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round|Open+Sans">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">




<!-- <div class="department_table" hx-target="#department_table" hx-swap="outerHTML"> -->
     <div class="search_data">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Управления:</th>
                        <th>Инструменты:</th>
                    </tr>
                </thead>
                <tbody id="department_table" hx-target="closest tr" hx-swap="outerHTML">
                    {% for value in extract_management_data %}
                    <tr>
                        <td hx-get="/data/mgm_edit" hx-target="#department_table" hx-trigger="click">
                            {{value.management_name}}
                        <td class="table_tools">
                            <!-- <a hx-get="/data/mgm_edit" hx-target="#department_table" class="edit" title="Edit" data-toggle="tooltip"><i class="material-icons"></i></a> -->
                            <!-- <a class="delete" title="Delete" data-toggle="tooltip"><i class="material-icons"></i></a> -->

                            <button type="button" class="btn btn-outline-danger">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                    <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"></path>
                    </svg>
                                Удалить
                              </button>

                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>    

{%endblock%}