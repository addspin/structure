{%extends "base.html"%}
{%block data%}
{{side_pos}}
{%endblock%}

{%block data_form%}

<div id="search" class="search">
    <form id="search_form" class="" >
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Управление:</span>
            <input class="form-control" list="datalistOptions" id="management" name="management" placeholder="Название управления или другой корневой структурной единицы" >
            <datalist id="datalistOptions" >
                {% for value in extract_management_data %}
                <option value="{{value.management_name}}">
                {% endfor %}
            </datalist>
                
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Отдел:</span>
            <input class="form-control" list="datalistOptions1" id="department" name="department" placeholder="Название отдела" >
            <datalist id="datalistOptions1">
                {% for value in extract_department_data %}
                <option value="{{value.department_name}}">
                {% endfor %}
            </datalist>
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Должность:</span>
            <input class="form-control" list="datalistOptions2" id="job" name="job" placeholder="Название должности" >
            <datalist id="datalistOptions2">
                {% for value in extract_job_data %}
                <option value="{{value.job_name}}">
                {% endfor %}
            </datalist>
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text" id="basic-addon1">Пользователь:</span>
            <input class="form-control" list="datalistOptions/" id="user" name="user" placeholder="Ф.И.О" >
            <datalist id="datalistOptions/">
                {% for value in extract_user_name_data %}
                <option value="{{value.user_name}}">
                {% endfor %}
            </datalist>
        </div>
    </form>
    <div class="button_line">
        <div class="" >
            <input hx-trigger="click" hx-post="/data" hx-target="#main" hx-include="#search_form" class="btn btn-warning" type="submit" value="Добавить">
        </div>
        <div class="" >
            <input hx-trigger="click" hx-post="/remove_data" hx-target="#main" hx-include="#search_form" class="btn btn-danger" type="submit" value="Удалить">
        </div>
    </div>
    <div class="message_data">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
            {% if category == 'management-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'department-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'job-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'user-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись добавлена!
                </div>
            {% elif category == 'management-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'department-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'job-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% elif category == 'user-remove-info' %}
                {% set alert_class = 'alert-success' %}
                <div class="alert {{alert_class}} fade show" role="alert">
                    <strong>{{ message }}</strong> - запись удалена!
                </div>
            {% endif %}
        {% endfor %}
    {% endwith %}
    </div>
</div>


<!-- <div class="department_table" hx-target="#department_table" hx-swap="outerHTML"> -->
<div class="search_data">
    <table class="tables st  ">
        <!-- table-bordered -->
        <thead>
            <tr >
                <th >Управления:</th>
                <!-- <th style="border-width: 0px;">Инструменты:</th> -->
            </tr>
        </thead>
        <tbody  id="department_table" hx-target="closest tr" hx-swap="outerHTML">
            {% for value in extract_management_data %}
            <tr >
                <td  hx-get="/data/mgm_edit" hx-target="#department_table" hx-trigger="click">
                    {{value.management_name}}
                <td class="table_tools">
                    <button type="button" class="btn btn-outline-danger">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"></path>
                            <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"></path>
                          </svg>
                        Удалить
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{%endblock%}